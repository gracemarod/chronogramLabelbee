<!-- Deleting everything on the svg so we can recreate the updated graph -->
<!-- d3.selectAll("svg > *").remove(); -->
<!-- Emptying the array so we won't have duplicates -->
<DOCTYPE html>
<html lan="en">


    <head>
        <script src="https://d3js.org/d3.v3.js"></script>
        <!-- <link rel="stylesheet" type="text/css" href="graphStyle.css"> -->
        <meta charset="utf-8">
    </head>
        <style>
            body {
              font: 11px sans-serif;
            }

            .axis path,
            .axis line {
              fill: none;
              stroke: #000;
              shape-rendering: crispEdges;
            }

            .dot {
              stroke: #000;
            }

            .tooltip {
              position: absolute;
              width: 200px;
              height: 28px;
              pointer-events: none;
            }
        </style>
        <body>
            <script type="text/javascript">
            

                var chronogramData = new Array();
                var Tracks_json = '[{"1":{"ID":"1","time":0,"frame":0,"x":1056,"y":540,"cx":1122,"cy":658,"width":132,"height":236,"bool_acts":[true,false,false,false]}}]';

                var Tracks_json2 = '[{"0":{"ID":"0","time":0.647972,"frame":14,"x":764,"y":348,"cx":862,"cy":428,"width":196,"height":160,"bool_acts":[false,false,false,true]}},{"1":{"ID":"1","time":0.909100909090909,"frame":20,"x":148,"y":248,"cx":282,"cy":314,"width":268,"height":132,"bool_acts":[false,false,false,true]},}]'

                var Tracks_json3 = '[{"0":{"ID":"0","time":0,"frame":0,"x":1080,"y":500,"cx":1120,"cy":622,"width":80,"height":244,"bool_acts":[false,false,true,false]}},null,null,null,null,null,null,null,null,{"1":{"ID":"1","time":0.425728,"frame":9,"x":1188,"y":456,"cx":1298,"cy":574,"width":220,"height":236,"bool_acts":[false,false,true,false]}},{"1":{"ID":"1","time":0.454555,"frame":10,"x":1180,"y":428,"cx":1318,"cy":562,"width":276,"height":268,"bool_acts":[false,false,false,true]}}]'
                
                // var Tracks;
                // d3.json('Tracks-4.json', function(data){
                //     // console.log("Data: ",data);
                //     Tracks = data;
                // });
                // console.log("T: ", Tracks)
                var bool_acts = [];

// }
               function chronoObservation() {
                    this.x = 0;
                    this.y = 0;
                    this.Activity = "";
                }
                var Tracks = JSON.parse(Tracks_json3);
                var chronoObs = new chronoObservation();

 
                // for (var i = 0; i < chronogramData.length; i++)
                //     chronogramData.pop();
                for (F in Tracks) {
                    for (id in Tracks[F]) {
                        chronoObs = new chronoObservation();
                        chronoObs.x = F;
                        chronoObs.y = id;
                        // console.log("Tracks: ",Tracks);
                        //small rectangle for each event
                        if (Tracks[F][id].bool_acts[0]) {
                            chronoObs.Activity = "fanning";
                        } else if (Tracks[F][id].bool_acts[1]) {
                            chronoObs.Activity = "pollenating";
                        } else if (Tracks[F][id].bool_acts[2]) {
                            chronoObs.Activity = "entering";
                        } else if (Tracks[F][id].bool_acts[3]) {
                            chronoObs.Activity = "exiting";
                        }

                        chronogramData.push(chronoObs);
                        // console.log(Tracks[F][id].bool_acts[0])
                    }

                }
                console.log("Data: ", chronogramData);
                //chronogramdata => x = frame number and y= bee number
                //frame number/ frame per second
                // d3.selectAll("svg > *").remove();
                    // drawChrono();

                //Make scatter plot graph
                
                var margin = {top: 20,right:20,bottom:30,left:40 },
                    width = 960-margin.left -margin.right,
                    height=500 - margin.top -margin.bottom;
                
                // //Setup x
                // var xVal = function(d){ return chronoObs.x;}, //data -> value
                //     xScale = d3.scale.linear().range([0,width]) //value -> display
                //     xMap = function(d){return xScale(xVal(d));}, //date -> display
                //     xAxis =d3.svg.axis().scale(xScale).orient("bottom");
                // //setup y
                // var yVal = function(d){return chronoObs.y;}, //data -> value
                //     yScale = d3.scale.linear().range([height, 0]), //value -> display
                //     yMap = function(d) {return yScale(yVal(d));}, //date -> display
                //     yAxis = d3.svg.axis().scale(yScale).orient("left");


                var x = d3.scale.linear()
                    .range([0, width])
                    .domain([d3.min(chronogramData,
                            function(d) {
                                return Number(d.x) - 0.5;
                            }),
                        d3.max(chronogramData,
                            function(d) {
                                return Number(d.x) + 0.5;                      })
                    ]);

                var y = d3.scale.linear()
                    .range([0, height])
                    .domain([d3.min(chronogramData,
                            function(d) {
                                return Number(d.y) - 0.5;
                            }),
                        d3.max(chronogramData,
                            function(d) {
                                return Number(d.y) + 0.5;
                            })
                    ]);

                var graph = d3.select('body')
                    .append('svg:svg')
                    .attr('width',width + margin.right + margin.left)
                    .attr('height', height + margin.top + margin.bottom)
                    .attr('class','chart')

                var main = graph.append('g')
                    .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')
                    .attr('width', width)
                    .attr('height',height)
                    .attr('class', 'main')

                //draw the x axis
                var xAxis = d3.svg.axis()
                    .scale(x)
                    .orient('bottom')
                    .tickSize(-height);     //makes x grids


                main.append('g')
                    .attr('transform', 'translate(0,' +height + ')')
                    .attr('class', 'main axis date')
                    .call(xAxis)
                    .append("text")
                    .attr("class","label")
                    .attr("x",width)
                    .attr("y", -6)
                    .style("text-anchor","end")
                    .text("Frames")

                //draw the y axis 
                var yAxis = d3.svg.axis()
                    .scale(y)
                    .orient('left')
                    .tickSize(-width); //makes y grids
                    

                main.append('g')
                    .attr('transform','translate(0,0)')
                    .attr('class', 'main axis date')
                    .call(yAxis)
                    .append("text")
                    .attr("class", "label")
                    .attr("transform","rotate(-90)")
                    .attr("y",6)
                    .attr("dy", ".71em")
                    .style("text-anchor", "end")
                    .text("Bee ID");

                var g = main.append("svg:g")
                g.selectAll(".chart")
                    .data(chronogramData)
                    .enter()
                    .insert("rect")
                    .attr("x", function(d) {return x(Number(d.x));})
                    .attr("y", function(d) {    return y(Number(d.y));})
                    .attr("height", function(d) { return (y(Number(d.y)) - y(Number(d.y) - 0.2));})
                    .attr("width", function(d) {return (x(Number(d.x) + 1) - x(d.x));})
                    .style("fill", function(d) {
                            var color = "black";
                            if (d.Activity == "fanning")
                                color = "#99CCFF";
                            else if (d.Activity == "pollenating")
                                color = "#FFFF00";
                            else if (d.Activity == "entering")
                                color = "#CC00FF";
                            else if (d.Activity == "exiting")
                                color = "#00CC99";
                            return color;
                    })
                    .style("stroke", "black");
           

                // xAxis = d3.svg.axis()
                //     .scale(x)
                //     .orient("bottom")
                //     .tickSize(-height);

                // yAxis = d3.svg.axis()
                //     .scale(y)
                //     .orient("left")
                //     .ticks(5)
                //     .tickSize(-width);
                

                // //add the canvas to the webpage
                // var svg = d3.select("body").append("svg")
                //     .attr("width", width + margin.left + margin.right)
                //     .attr("height", height + margin.top +margin.right)
                //     // .append(g)
                //         .attr("transform", "translate(" +margin.left +"," +margin.top +")");
                // //x-axis
                //     svg.append("g")
                //     svg.attr("class", "x axis")
                //         .attr("transform", "translate(0," +height + ")")
                //         .call(xAxis)
                //         .append("text")
                //         .attr("class","label")
                //         .attr("x",width)
                //         .attr("y", -6)
                //         .style("text-anchor","end")
                //         .text("Frames")

                // //y-axis
                //     svg.append("g")
                //         .attr("class", "y axis")
                //         .call(yAxis)
                //         .append("text")
                //         .attr("class", "label")
                //         .attr("transform","rotate(-90)")
                //         .attr("y",6)
                //         .attr("dy", ".71em")
                //         .style("text-anchor", "end")
                //         .text("Bee ID");

                //     console.log("here")
                //     //draw dots
                //     svg.selectAll(".dot")
                //         .data(chronogramData)
                //         .enter()
                //         .append("circle")
                //         .attr("class", "dot")
                //         .attr("r",3.5)
                //         .attr("cx", function(d) { return x(Number(d.x) - 0.5);})
                //         .attr("cy", function(d) { return y(Number(d.y) - 0.4);})
                        // .style("fill", function(d){ return color(cValue(d));})
                        // .style("fill", function(d){})
//______________________________________________________________________________________
            //Code from labelBee.js. Doesn't display anything
            // var margin = {
            //         top: 20,
            //         right: 20,
            //         bottom: 30,
            //         left: 40
            //     },
            //     width = 960 - margin.left - margin.right,
            //     height = 300 - margin.top - margin.bottom;

            // var x = d3.scale.linear()
            //     .range([0, width])
            //     .domain([d3.min(chronogramData,
            //             function(d) {
            //                 return Number(d.x) - 0.5;
            //             }),
            //         d3.max(chronogramData,
            //             function(d) {
            //                 return Number(d.x) + 0.5;
            //             })
            //     ]);

            // var y = d3.scale.linear()
            //     .range([0, height])
            //     .domain([d3.min(chronogramData,
            //             function(d) {
            //                 return Number(d.y) - 0.5;
            //             }),
            //         d3.max(chronogramData,
            //             function(d) {
            //                 return Number(d.y) + 0.5;
            //             })
            //     ]);

            // xAxis = d3.svg.axis()
            //     .scale(x)
            //     .orient("bottom")
            //     .tickSize(-height);

            // yAxis = d3.svg.axis()
            //     .scale(y)
            //     .orient("left")
            //     .ticks(5)
            //     .tickSize(-width);
            // _________________________________________________
                
            // vis = d3.select("#svgVisualize")
            //     .attr("width", width + margin.left + margin.right)
            //     .attr("height", height + margin.top + margin.bottom)
            //     .append("g")
            //     .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
            //     // .call(zoom);

            // vis.append("rect")
            //     .attr("width", width)
            //     .attr("height", height)
            //     .style("fill", "#f0f0ff")
            //     .style("stroke", "gray")

            // vis.append("g")
            //     .attr("class", "x axis")
            //     .attr("transform", "translate(0," + height + ")")
            //     .call(xAxis);

            // vis.append("g")
            //     .attr("class", "y axis")
            //     .call(yAxis);

            // var chronArea = vis.append("g");
            // var timeMark = chronArea.append("rect")
            //     .attr("x", function(d) {
            //         return x(Number(getCurrentFrame()) - 0.05);
            //     })
            //     .attr("y", function(d) {
            //         return y(-0.5);
            //     })
            //     .attr("height", function(d) {
            //         return (y(Number(y.range()[1]) + 0.5) - y(-0.5));
            //     })
            //     .attr("width", function(d) {
            //         return (x(0.1) - x(0.0));
            //     })
            //     .style("fill", "#ff0000")

            // circles = chronArea.append("g").selectAll("rect").data(chronogramData);

            // circles
            //     .enter()
            //     .insert("rect")
            //     .attr("x", function(d) {
            //         return x(Number(d.x) - 0.5);
            //     })
            //     .attr("y", function(d) {
            //         return y(Number(d.y) - 0.4);
            //     })
            //     .attr("height", function(d) {
            //         return (y(Number(d.y) + 0.4) - y(Number(d.y) - 0.4));
            //     })
            //     .attr("width", function(d) {
            //         return (x(Number(d.x) + 1) - x(d.x));
            //     })
            //     .style("fill", function(d) {
            //         var color = "black";
            //         if (d.Activity == "fanning")
            //             color = "#99CCFF";
            //         else if (d.Activity == "entering")
            //             color = "#FFFF00";
            //         else if (d.Activity == "exiting")
            //             color = "#CC00FF";
            //         else if (d.Activity == "pollenating")
            //             color = "#00CC99";
            //         return color;
            //     })
            //     .style("stroke", "black");
            </script>
        </body>
    </head>
</html>